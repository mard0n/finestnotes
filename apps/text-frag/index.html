<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fragment</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/wicked-good-xpath/1.2.6/wgxpath.install.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/get-xpath@3.3.0/index.umd.min.js"></script>
  <script type="module" src="./fragment-generation-utils.js"></script>
  <script type="module" src="./create-frag.js"></script>
  <script type="module">
    import { createTextFragment } from './create-frag.js';

    // trigger on keyboard shortcut (Ctrl+Shift+U)
    document.addEventListener('keydown', (event) => {
      console.log('Key down event:', event);
      console.log('Meta:', event.metaKey, 'Ctrl:', event.ctrlKey, 'Shift:', event.shiftKey, 'Key:', event.key);
      if (event.metaKey && event.shiftKey && event.key === 'u') {
        console.log('Ctrl+Shift+U pressed');
        const selection = document.getSelection();
        if (selection && !selection.isCollapsed) {
          try {
            // const fragmentUrl = createTextFragment(selection);
            const fragmentUrl = getXPath(selection.anchorNode);
            const element = document.evaluate(fragmentUrl, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
            console.log('Generated Text Fragment URL:', fragmentUrl);
            console.log('Element from XPath:', element);
          } catch (error) {
            console.error('Error generating text fragment:', error);
          }
        }
      }
    });
  </script>
</head>

<body>
  Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat voluptatem similique facere recusandae numquam
  repudiandae obcaecati quaerat vero provident laboriosam illo animi rerum, cupiditate vel! Adipisci optio omnis magnam
  dignissimos. <br>
  Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat voluptatem similique facere recusandae numquam
  repudiandae obcaecati quaerat vero provident laboriosam illo animi rerum, cupiditate vel! Adipisci optio omnis magnam
  dignissimos. <br>
  Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat voluptatem similique facere recusandae numquam
  repudiandae obcaecati quaerat vero provident laboriosam illo animi rerum, cupiditate vel! Adipisci optio omnis magnam
  dignissimos.
</body>

</html>