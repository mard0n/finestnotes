---
import Layout from "@layouts/Layout.astro";
import { client } from "@utils/types";
import type { InferResponseType } from "hono";

export const prerender = false;

var articles: InferResponseType<typeof client.api.articles.$get> = [];

try {
	let url = client.api.articles.$url(); // Log the URL to verify it's correct
	console.log("Fetching notes from URL:", url.toString());
	const res = await client.api.articles.$get().then((r) => {
		console.log("Fetched notes:", r);
		return r;
	});
	if (res.ok) {
		articles = await res.json();
	}
	console.log("articles", articles);
} catch (error) {
	console.error("Error fetching notes:", error);
}
---

<Layout>
	<ul>
		{
			articles.map((article) => (
				<li>
					<a href={article.link} target="_blank" rel="noopener noreferrer">
						{article.title}
					</a>
					<p>{article.description}</p>
				</li>
			))
		}
		{articles.length === 0 && <li>No articles found.</li>}
	</ul>
</Layout>
