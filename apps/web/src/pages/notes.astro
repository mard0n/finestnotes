---
import Layout from "@layouts/Layout.astro";
import NotesComponent from "@components/Notes.jsx";
import { createServerClient } from "@utils/api";
import { parseResponse } from "hono/client";

if (!Astro.locals.user) {
  return Astro.redirect("/login");
}

const res = await createServerClient(
  Astro.request.headers,
).api.collections.$get();

const collections = await parseResponse(res);
---

<Layout>
  <NotesComponent client:load collections={collections} />
</Layout>