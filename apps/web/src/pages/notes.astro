---
import { createServerClient } from "@utils/api";
import { parseResponse } from "hono/client";
import { NotePage } from "@components/Notes";
import Layout from "@layouts/Layout.astro";

if (!Astro.locals.user) {
  return Astro.redirect("/login");
}

const res = await createServerClient(
  Astro.request.headers,
).api.collections.$get();

const collections = await parseResponse(res);
---

<Layout>
  <Fragment slot="navbar"></Fragment>
  <NotePage
    client:only="react"
    collections={collections}
    user={Astro.locals.user}
  />
  <style>
    html {
      height: 100vh;
    }
    body {
      height: 100%;
      display: flex;
      flex-direction: column;
    }
  </style>
</Layout>
